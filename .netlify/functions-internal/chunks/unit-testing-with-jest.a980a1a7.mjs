import { h as createVNode, i as spreadAttributes, F as Fragment } from './astro.af0e87f3.mjs';
import 'html-escaper';
import 'cookie';
import 'kleur/colors';
import 'slash';
import 'path-to-regexp';
import 'mime';
import 'string-width';

const images = {
					
				};

				function updateImageReferences(html) {
					return html.replaceAll(
						/__ASTRO_IMAGE_="(.+)"/gm,
						(full, imagePath) => spreadAttributes({src: images[imagePath].src, ...images[imagePath].attributes})
					);
				}

				const html = updateImageReferences("<h1 id=\"introduction-to-jest\">Introduction to Jest</h1>\n<p><a href=\"https://jestjs.io/\">jest.io</a></p>\n<p>It is the most popular framework out there and most of the concepts apply to all testing frameworks and can be useful no matter which technology you are using.</p>\n<h2 id=\"installation\">Installation</h2>\n<p>Jest can be installed using either npm or yarn:</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #c9d1d9\"># or</span></span>\n<span class=\"line\"><span style=\"color: #c9d1d9\">npm install --save-dev jest</span></span></code></pre>\n<p>but in order to be able to use esm modules, test DOM related issues and mock the objects as needed we’ll also have to install <strong>babel-jest</strong> , <strong>jest-environment-jsdom</strong>, <strong>jsdom</strong>, <strong>jsdom-testing-mocks</strong>, so probably we’ll start with:</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #c9d1d9\"># or</span></span>\n<span class=\"line\"><span style=\"color: #c9d1d9\">npm install --save-dev jest babel-jest jest-environment-jsdom jsdom jsdom-testing-mocks</span></span></code></pre>\n<p>To run your test using the test command :</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #C9D1D9\">{</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #7EE787\">\"scripts\"</span><span style=\"color: #C9D1D9\">: {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #7EE787\">\"test\"</span><span style=\"color: #C9D1D9\">: </span><span style=\"color: #A5D6FF\">\"jest\"</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  }</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">}</span></span></code></pre>\n<h2 id=\"a-first-basic-test\">A first basic test</h2>\n<p>Imagine we have a Cookie.js module, like so:</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #8B949E\">/**</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * gets cookie value</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * </span><span style=\"color: #FF7B72\">@param</span><span style=\"color: #8B949E\"> </span><span style=\"color: #FFA657\">{String}</span><span style=\"color: #8B949E\"> </span><span style=\"color: #C9D1D9\">name</span><span style=\"color: #8B949E\"> : cookie name</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> */</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">export</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">getCookie</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> (</span><span style=\"color: #FFA657\">name</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\"> document.cookie.</span><span style=\"color: #D2A8FF\">split</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'; '</span><span style=\"color: #C9D1D9\">).</span><span style=\"color: #D2A8FF\">reduce</span><span style=\"color: #C9D1D9\">((</span><span style=\"color: #FFA657\">r</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">v</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">parts</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> v.</span><span style=\"color: #D2A8FF\">split</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'='</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\"> parts[</span><span style=\"color: #79C0FF\">0</span><span style=\"color: #C9D1D9\">] </span><span style=\"color: #FF7B72\">===</span><span style=\"color: #C9D1D9\"> name </span><span style=\"color: #FF7B72\">?</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">decodeURIComponent</span><span style=\"color: #C9D1D9\">(parts[</span><span style=\"color: #79C0FF\">1</span><span style=\"color: #C9D1D9\">]) </span><span style=\"color: #FF7B72\">:</span><span style=\"color: #C9D1D9\"> r</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  }, </span><span style=\"color: #A5D6FF\">''</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #8B949E\">/**</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * Sets a cookie</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * </span><span style=\"color: #FF7B72\">@param</span><span style=\"color: #8B949E\"> </span><span style=\"color: #FFA657\">{String}</span><span style=\"color: #8B949E\"> </span><span style=\"color: #C9D1D9\">name</span><span style=\"color: #8B949E\"> : cookie name</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * </span><span style=\"color: #FF7B72\">@param</span><span style=\"color: #8B949E\"> </span><span style=\"color: #FFA657\">{*}</span><span style=\"color: #8B949E\"> </span><span style=\"color: #C9D1D9\">value</span><span style=\"color: #8B949E\"> : cookie value</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * </span><span style=\"color: #FF7B72\">@param</span><span style=\"color: #8B949E\"> </span><span style=\"color: #FFA657\">{Number}</span><span style=\"color: #8B949E\"> </span><span style=\"color: #C9D1D9\">days</span><span style=\"color: #8B949E\"> : cookie validity (in days)</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * </span><span style=\"color: #FF7B72\">@param</span><span style=\"color: #8B949E\"> </span><span style=\"color: #FFA657\">{String}</span><span style=\"color: #8B949E\"> </span><span style=\"color: #C9D1D9\">path</span><span style=\"color: #8B949E\"> : the path to get the cookie</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> */</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">export</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">setCookie</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> (</span><span style=\"color: #FFA657\">name</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">value</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">days</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">7</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">path</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'/'</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">expires</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">new</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">Date</span><span style=\"color: #C9D1D9\">(Date.</span><span style=\"color: #D2A8FF\">now</span><span style=\"color: #C9D1D9\">() </span><span style=\"color: #FF7B72\">+</span><span style=\"color: #C9D1D9\"> days </span><span style=\"color: #FF7B72\">*</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">864e5</span><span style=\"color: #C9D1D9\">).</span><span style=\"color: #D2A8FF\">toUTCString</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  document.cookie </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> name </span><span style=\"color: #FF7B72\">+</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'='</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">+</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">encodeURIComponent</span><span style=\"color: #C9D1D9\">(value) </span><span style=\"color: #FF7B72\">+</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'; expires='</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">+</span><span style=\"color: #C9D1D9\"> expires </span><span style=\"color: #FF7B72\">+</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'; path='</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">+</span><span style=\"color: #C9D1D9\"> path</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #8B949E\">/**</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * Cancella un cookie</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * </span><span style=\"color: #FF7B72\">@param</span><span style=\"color: #8B949E\"> </span><span style=\"color: #FFA657\">{*}</span><span style=\"color: #8B949E\"> </span><span style=\"color: #C9D1D9\">name</span><span style=\"color: #8B949E\"> : il nome del cookie</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * </span><span style=\"color: #FF7B72\">@param</span><span style=\"color: #8B949E\"> </span><span style=\"color: #FFA657\">{*}</span><span style=\"color: #8B949E\"> </span><span style=\"color: #C9D1D9\">path</span><span style=\"color: #8B949E\"> : il percorso per recuperare il cookie</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> */</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">export</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">deleteCookie</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> (</span><span style=\"color: #FFA657\">name</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">path</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'/'</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">setCookie</span><span style=\"color: #C9D1D9\">(name, </span><span style=\"color: #A5D6FF\">''</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FF7B72\">-</span><span style=\"color: #79C0FF\">1</span><span style=\"color: #C9D1D9\">, path)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">}</span></span></code></pre>\n<p>testing the module could look like so:</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #8B949E\">/**</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * @jest-environment jsdom</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> */</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> { setCookie,getCookie,deleteCookie } </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'../Cookie'</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> { getCookie } </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'../getCookie'</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> { deleteCookie } </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'../deleteCookie'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">describe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'test Cookies functions'</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"sets a 'pippo' cookie in / checks if it exists and deletes it\"</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">setCookie</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'pippo'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #79C0FF\">3</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #79C0FF\">7</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #D2A8FF\">getCookie</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'pippo'</span><span style=\"color: #C9D1D9\">)).</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'3'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">deleteCookie</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'pippo'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #D2A8FF\">getCookie</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'pippo'</span><span style=\"color: #C9D1D9\">)).</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">''</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  })</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">})</span></span></code></pre>\n<p>Please note that without jsdom and jest-environment-jsdom installed and the  @jest-environment comment the test would fail, as Cookie.js relies on the existence of the window.document object</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #8B949E\">/**</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * @jest-environment jsdom</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> */</span></span></code></pre>\n<h2 id=\"matchers\">Matchers</h2>\n<p>Matchers let you validate the results and values of your tests in different ways.</p>\n<p>They are most commonly used to compare the result of the expect() function to the value passed as an argument to the matcher (That is also what we did above).</p>\n<p>Most common matchers:</p>\n<ul>\n<li>toBe -  compares for strict equality (e.g. ===)</li>\n<li>toEqual - compares the values of two variables/objects</li>\n<li>toBeNull - checks if the value is null</li>\n<li>toBeDefined - checks if the value is defined</li>\n<li>toBeUndefined - checks if the value is undefined</li>\n<li>toBeTruthy - checks if the value is true (similar to an if statement)</li>\n<li>toBeFalsy - checks if the value is false(similar to an if statement)</li>\n<li>toBeGreaterThan - checks if the result of the expect() function is greater than the argument</li>\n<li>toContain - checks if the result of expect() contains a value</li>\n<li>toHaveProperty -  checks if an object has a property, and optionally checks its value</li>\n<li>toBeInstanceOf - checks if an object is an instance of a class</li>\n</ul>\n<p>matchers can also be negated using the not statement:</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"factorial of 3 is not 5\"</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #D2A8FF\">factorialize</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">3</span><span style=\"color: #C9D1D9\">)).not.</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">5</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">});</span></span></code></pre>\n<h2 id=\"setup-and-teardown\">Setup and Teardown</h2>\n<p>Often when writing tests, you will have to do some kind of setup like initializing variables before tests run and some sort of action after they have finished, remember the <strong>AAA Pattern</strong> (Arrange, Act, Assert) ?</p>\n<p>Jest provides two different ways you can do that.</p>\n<h2 id=\"one-time-setup\">One-Time Setup:</h2>\n<p>In some cases, you only need to do the setup once, at the beginning of your test file. In that scenario, you can use the beforeAll() and afterAll() helper functions that will execute before the tests start and after all have finished.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">beforeAll</span><span style=\"color: #C9D1D9\">(() </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">initializeDatabase</span><span style=\"color: #C9D1D9\">();</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">afterAll</span><span style=\"color: #C9D1D9\">(() </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">clearDatabase</span><span style=\"color: #C9D1D9\">();</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'query from database'</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(database.</span><span style=\"color: #D2A8FF\">getObject</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'Florida'</span><span style=\"color: #C9D1D9\">)).</span><span style=\"color: #D2A8FF\">toBeTruthy</span><span style=\"color: #C9D1D9\">();</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">});</span></span></code></pre>\n<h2 id=\"repeating-setup-for-each-test\">Repeating setup for each test:</h2>\n<p>If you have a setup process that needs to run before each test than you should use the beforeEach() and afterEach() functions.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">beforeEach</span><span style=\"color: #C9D1D9\">(() </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    IntersectionHandler.</span><span style=\"color: #D2A8FF\">init</span><span style=\"color: #C9D1D9\">({})</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    document.body.innerHTML </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">''</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\"> })</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">afterEach</span><span style=\"color: #C9D1D9\">(() </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">     IntersectionHandler.</span><span style=\"color: #D2A8FF\">clear</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">     jest.</span><span style=\"color: #D2A8FF\">clearAllMocks</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\"> })</span></span></code></pre>\n<h2 id=\"grouping-tests\">Grouping tests</h2>\n<p>You can also group related tests together so you can isolate the setup and teardown functions. Grouping tests will also help you get a better overview of your different test cases.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">describe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'testing factorial function'</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">beforeAll</span><span style=\"color: #C9D1D9\">(() </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    \t</span><span style=\"color: #8B949E\">//do something</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    })</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">afterAll</span><span style=\"color: #C9D1D9\">(() </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    \t</span><span style=\"color: #8B949E\">//do something</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    })</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"factorial of 3\"</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    \t</span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #D2A8FF\">factorialize</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">3</span><span style=\"color: #C9D1D9\">)).</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">6</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    });</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"factorial of 5\"</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">        </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #D2A8FF\">factorialize</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">5</span><span style=\"color: #C9D1D9\">)).</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">120</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    });</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"factorial of 3 is not 5\"</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">        </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #D2A8FF\">factorialize</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">3</span><span style=\"color: #C9D1D9\">)).not.</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">5</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    });</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">})</span></span></code></pre>\n<h2 id=\"testing-async-functions\">Testing async functions</h2>\n<p>It is common for Javascript code to run asynchronously using either promises or callbacks. The problem with testing asynchronous code is knowing when the code that you are testing is actually complete. Jest has several ways to handle this.</p>\n<h3 id=\"promises\">Promises:</h3>\n<p>Testing promises is straight forward in Jest. Just return the promise and Jest will wait for the promise to resolve. If the promise fails, the test will automatically fail aswell.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #8B949E\">// string.js</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">export</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">reverseString</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FFA657\">str</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">new</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">Promise</span><span style=\"color: #C9D1D9\">((</span><span style=\"color: #FFA657\">resolve</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">reject</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">if</span><span style=\"color: #C9D1D9\"> (</span><span style=\"color: #FF7B72\">!</span><span style=\"color: #C9D1D9\">str) {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">      </span><span style=\"color: #D2A8FF\">reject</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"Empty string\"</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">      </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\">;</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    }</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">resolve</span><span style=\"color: #C9D1D9\">(str.</span><span style=\"color: #D2A8FF\">split</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"\"</span><span style=\"color: #C9D1D9\">).</span><span style=\"color: #D2A8FF\">reverse</span><span style=\"color: #C9D1D9\">().</span><span style=\"color: #D2A8FF\">join</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"\"</span><span style=\"color: #C9D1D9\">));</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  });</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">};</span></span></code></pre>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #8B949E\">// string.spec.js</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> {reverseString}  </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\">  </span><span style=\"color: #A5D6FF\">\"./string\"</span><span style=\"color: #C9D1D9\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">`reverseString 'String' to equal 'gnirtS'`</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">reverseString</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"String\"</span><span style=\"color: #C9D1D9\">).</span><span style=\"color: #D2A8FF\">then</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #FFA657\">str</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(str).</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"gnirtS\"</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  });</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">});</span></span></code></pre>\n<p>You can also catch rejected promises using the catch() function.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">`reverseString '' to reject promise`</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">reverseString</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"String\"</span><span style=\"color: #C9D1D9\">).</span><span style=\"color: #D2A8FF\">catch</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #FFA657\">error</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(error).</span><span style=\"color: #D2A8FF\">toMatch</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"Empty string\"</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  });</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">});</span></span></code></pre>\n<h3 id=\"async-await\">Async await:</h3>\n<p>Alternatively, we can use async and await for testing promises.</p>\n<p>const reverseString = require(“./string”);</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">`reverseString 'String' to equal 'gnirtS' using await`</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FF7B72\">async</span><span style=\"color: #C9D1D9\"> () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">str</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">await</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">reverseString</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"String\"</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(str).</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"gnirtS\"</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">});</span></span></code></pre>\n<h3 id=\"callbacks\">Callbacks:</h3>\n<p>By default Jest tests complete once they reach the end of their execution which means that the test will be completed before the callback is called. This can be fixed by passing a single argument named done to your test function. <strong>Jest will wait until the done callback is called</strong> before finishing the test.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #8B949E\">// string.js</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">export</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">function</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">reverseStringCallback</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #FFA657\">str</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">callback</span><span style=\"color: #C9D1D9\">) {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">callback</span><span style=\"color: #C9D1D9\">(str.</span><span style=\"color: #D2A8FF\">split</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"\"</span><span style=\"color: #C9D1D9\">).</span><span style=\"color: #D2A8FF\">reverse</span><span style=\"color: #C9D1D9\">().</span><span style=\"color: #D2A8FF\">join</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"\"</span><span style=\"color: #C9D1D9\">))</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">}</span></span></code></pre>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #8B949E\">// string.spec.js</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> {reverseStringCallback}  </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\">  </span><span style=\"color: #A5D6FF\">\"./string\"</span><span style=\"color: #C9D1D9\">;</span></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">`reverseStringCallback 'string' to equal 'gnirts'`</span><span style=\"color: #C9D1D9\">, (</span><span style=\"color: #FFA657\">done</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">reverseStringCallback</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'string'</span><span style=\"color: #C9D1D9\">, (</span><span style=\"color: #FFA657\">str</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">      </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(str).</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'gnirts'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">      </span><span style=\"color: #D2A8FF\">done</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    })</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">})</span></span></code></pre>\n<p>Note that if done() is never called, the test will fail with a timeout error.</p>\n<h2 id=\"mocking\">Mocking</h2>\n<p>Mocking is creating objects or services that simulate the behavior of real objects and plays a vital part in testing. The goal for mocking an object or function is to replace something we don’t control like an external service with something we do, that is why it’s essential that what we replace it with something that has all the features we need.</p>\n<h3 id=\"passing-mocks-to-functions\">Passing Mocks to functions:</h3>\n<p>One of the common ways to use the Mock function is by passing it as an argument to the function you are testing. This allows you to run your tests without importing the real dependencies and objects you would pass in your real application.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">multiplyNumbers</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> (</span><span style=\"color: #FFA657\">a</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">b</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #FFA657\">callback</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">callback</span><span style=\"color: #C9D1D9\">(a </span><span style=\"color: #FF7B72\">*</span><span style=\"color: #C9D1D9\"> b);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">\"calls callback with arguments added\"</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">mockCallback</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> jest.</span><span style=\"color: #D2A8FF\">fn</span><span style=\"color: #C9D1D9\">();</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">multiplyNumbers</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">1</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">, mockCallback);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(mockCallback).</span><span style=\"color: #D2A8FF\">toHaveBeenCalledWith</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">});</span></span></code></pre>\n<p>This strategy is great, but requires that your code supports dependency injection. If that is not the case you will need to mock already existing modules or functions instead.</p>\n<h3 id=\"mocking-a-single-function\">Mocking a single function:</h3>\n<p>You can mock a single function using Jest.fn():</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">lodash</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">require</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'lodash'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">lodash.chunk </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> jest.</span><span style=\"color: #D2A8FF\">fn</span><span style=\"color: #C9D1D9\">(() </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'test'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">`Test lodash chunk function`</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">result</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> lodash.</span><span style=\"color: #D2A8FF\">chunk</span><span style=\"color: #C9D1D9\">([</span><span style=\"color: #A5D6FF\">'a'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'b'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'c'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'d'</span><span style=\"color: #C9D1D9\">], </span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(result).</span><span style=\"color: #D2A8FF\">toBe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'test'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(lodash.chunk).</span><span style=\"color: #D2A8FF\">toHaveBeenCalled</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(lodash.chunk).</span><span style=\"color: #D2A8FF\">toHaveBeenCalledWith</span><span style=\"color: #C9D1D9\">([</span><span style=\"color: #A5D6FF\">'a'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'b'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'c'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'d'</span><span style=\"color: #C9D1D9\">], </span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">})</span></span></code></pre>\n<h3 id=\"mocking-modules\">Mocking Modules:</h3>\n<p>Mocking single functions works well if you only use one or two functions of a package or library but can get very cluttered when you need more functions of a module. Here we use jest.mock to automatically set the exports of an entire module instead of mocking the modules manually.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">lodash</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">require</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'lodash'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">jest.</span><span style=\"color: #D2A8FF\">mock</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'lodash'</span><span style=\"color: #C9D1D9\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">`Test lodash chunk function`</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">result</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> lodash.</span><span style=\"color: #D2A8FF\">chunk</span><span style=\"color: #C9D1D9\">([</span><span style=\"color: #A5D6FF\">'a'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'b'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'c'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'d'</span><span style=\"color: #C9D1D9\">], </span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(lodash.chunk).</span><span style=\"color: #D2A8FF\">toHaveBeenCalled</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(lodash.chunk).</span><span style=\"color: #D2A8FF\">toHaveBeenCalledWith</span><span style=\"color: #C9D1D9\">([</span><span style=\"color: #A5D6FF\">'a'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'b'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'c'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'d'</span><span style=\"color: #C9D1D9\">], </span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">concatResult</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> lodash.</span><span style=\"color: #D2A8FF\">concat</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">, [</span><span style=\"color: #79C0FF\">3</span><span style=\"color: #C9D1D9\">], [[</span><span style=\"color: #79C0FF\">4</span><span style=\"color: #C9D1D9\">]]);</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(lodash.concat).</span><span style=\"color: #D2A8FF\">toHaveBeenCalled</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(lodash.concat).</span><span style=\"color: #D2A8FF\">toHaveBeenCalledWith</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">, [</span><span style=\"color: #79C0FF\">3</span><span style=\"color: #C9D1D9\">], [[</span><span style=\"color: #79C0FF\">4</span><span style=\"color: #C9D1D9\">]])</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">})</span></span></code></pre>\n<h3 id=\"mocking-esmodules\">Mocking ESModules</h3>\n<p>Jest was born with node modules in mind, in order to use it with ESModules you should install a transpiler such as <strong>babel-jest</strong></p>\n<p>Then the syntax is slightly different :</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> {loop} </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'../loop'</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> {ctx} </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'../init'</span><span style=\"color: #C9D1D9\">  </span><span style=\"color: #8B949E\">// this is used in loop()</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> { generateNoise } </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'../generateNoise'</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #8B949E\">// this is called in loop()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">jest.</span><span style=\"color: #D2A8FF\">mock</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'../generateNoise'</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> ({</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    __esModule: </span><span style=\"color: #79C0FF\">true</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #8B949E\">// without this tests will fail</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    generateNoise: jest.</span><span style=\"color: #D2A8FF\">fn</span><span style=\"color: #C9D1D9\">(), </span><span style=\"color: #8B949E\">// mocked function</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">}));</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">jest.</span><span style=\"color: #D2A8FF\">mock</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'../init'</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> ({</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    __esModule: </span><span style=\"color: #79C0FF\">true</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #8B949E\">// without this tests will fail</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    ctx: jest.</span><span style=\"color: #D2A8FF\">fn</span><span style=\"color: #C9D1D9\">(), </span><span style=\"color: #8B949E\">// mocked function</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">}));</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">describe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'testing loop'</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {         </span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #8B949E\">// @ts-ignore</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">it</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'calls loop  and verifies its logic'</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">        </span><span style=\"color: #D2A8FF\">loop</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">        </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(generateNoise).</span><span style=\"color: #D2A8FF\">toHaveBeenCalledWith</span><span style=\"color: #C9D1D9\">(ctx)  </span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    })</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">})</span></span></code></pre>\n<h2 id=\"spying-packages\">Spying packages:</h2>\n<p>You can also spy on a package without creating a mock for it. This is done using the spyOn() function provided by Jest.</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> lodash </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'lodash'</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\">// or </span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">lodash</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">require</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'lodash'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">`Test lodash chunk function`</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">spy</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> jest.</span><span style=\"color: #D2A8FF\">spyOn</span><span style=\"color: #C9D1D9\">(lodash, </span><span style=\"color: #A5D6FF\">'chunk'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">result</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> lodash.</span><span style=\"color: #D2A8FF\">chunk</span><span style=\"color: #C9D1D9\">([</span><span style=\"color: #A5D6FF\">'a'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'b'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'c'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'d'</span><span style=\"color: #C9D1D9\">], </span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(lodash.chunk).</span><span style=\"color: #D2A8FF\">toHaveBeenCalled</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(lodash.chunk).</span><span style=\"color: #D2A8FF\">toHaveBeenCalledWith</span><span style=\"color: #C9D1D9\">([</span><span style=\"color: #A5D6FF\">'a'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'b'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'c'</span><span style=\"color: #C9D1D9\">, </span><span style=\"color: #A5D6FF\">'d'</span><span style=\"color: #C9D1D9\">], </span><span style=\"color: #79C0FF\">2</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">})</span></span></code></pre>\n<h2 id=\"expecting-a-function-to-throw-error\">Expecting a function to throw error:</h2>\n<p>You should always take in account edge cases and the possibility that a funtion you are calling will generate an error.</p>\n<p>imagine we have a simple module which creates a div in anothe div:</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #FF7B72\">export</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">function</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">createContainerInMount</span><span style=\"color: #C9D1D9\"> (</span><span style=\"color: #FFA657\">selector</span><span style=\"color: #C9D1D9\">) {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">mount</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> document.</span><span style=\"color: #D2A8FF\">querySelector</span><span style=\"color: #C9D1D9\">(selector)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">if</span><span style=\"color: #C9D1D9\"> (mount) {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">const</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #79C0FF\">container</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> document.</span><span style=\"color: #D2A8FF\">createElement</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'div'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    container.id </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'test'</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    mount.</span><span style=\"color: #D2A8FF\">appendChild</span><span style=\"color: #C9D1D9\">(container)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #FF7B72\">return</span><span style=\"color: #C9D1D9\"> container</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  }</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #FF7B72\">throw</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #FF7B72\">new</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #D2A8FF\">Error</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'no mount found'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">}</span></span></code></pre>\n<p>we could test it like this:</p>\n<pre is:raw=\"\" class=\"astro-code\" style=\"background-color: #0d1117; overflow-x: auto;\"><code><span class=\"line\"><span style=\"color: #8B949E\">/**</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> * @jest-environment jsdom</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\"> */</span></span>\n<span class=\"line\"><span style=\"color: #8B949E\">/* eslint-disable no-undef */</span></span>\n<span class=\"line\"><span style=\"color: #FF7B72\">import</span><span style=\"color: #C9D1D9\"> { createContainerInMount } </span><span style=\"color: #FF7B72\">from</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">'../createContainerInMount'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D2A8FF\">describe</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'testing : createContainerInMount'</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'mount exists '</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    document.body.innerHTML </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">`</span></span>\n<span class=\"line\"><span style=\"color: #A5D6FF\">      &#x3C;div id=\"test\">&#x3C;/div></span></span>\n<span class=\"line\"><span style=\"color: #A5D6FF\">    `</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">createContainerInMount</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'#test'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(document.</span><span style=\"color: #D2A8FF\">querySelector</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'#test'</span><span style=\"color: #C9D1D9\">)).not.</span><span style=\"color: #D2A8FF\">toBeNull</span><span style=\"color: #C9D1D9\">()</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  })</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  </span><span style=\"color: #D2A8FF\">test</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'mount does not exist '</span><span style=\"color: #C9D1D9\">, () </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    document.body.innerHTML </span><span style=\"color: #FF7B72\">=</span><span style=\"color: #C9D1D9\"> </span><span style=\"color: #A5D6FF\">`</span></span>\n<span class=\"line\"><span style=\"color: #A5D6FF\">    `</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    </span><span style=\"color: #D2A8FF\">expect</span><span style=\"color: #C9D1D9\">(() </span><span style=\"color: #FF7B72\">=></span><span style=\"color: #C9D1D9\"> {</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">      </span><span style=\"color: #D2A8FF\">createContainerInMount</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'#test'</span><span style=\"color: #C9D1D9\">)</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">    }).</span><span style=\"color: #D2A8FF\">toThrow</span><span style=\"color: #C9D1D9\">(</span><span style=\"color: #A5D6FF\">'no mount found'</span><span style=\"color: #C9D1D9\">) </span><span style=\"color: #8B949E\">// Or .toThrow('expectedErrorMessage')</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">  })</span></span>\n<span class=\"line\"><span style=\"color: #C9D1D9\">})</span></span></code></pre>");

				const frontmatter = {};
				const file = "/Users/zp/Sites/DIGITIAMO/wc-playground/src/markdown/testing/unit-testing-with-jest.md";
				const url = undefined;
				function rawContent() {
					return "# Introduction to Jest\n\n[jest.io](https://jestjs.io/)\n\nIt is the most popular framework out there and most of the concepts apply to all testing frameworks and can be useful no matter which technology you are using.\n\n## Installation\nJest can be installed using either npm or yarn:\n```yarn add --dev jest\n# or\nnpm install --save-dev jest\n```\n\nbut in order to be able to use esm modules, test DOM related issues and mock the objects as needed we'll also have to install **babel-jest** , **jest-environment-jsdom**, **jsdom**, **jsdom-testing-mocks**, so probably we'll start with:\n\n```yarn add --dev jest babel-jest jest-environment-jsdom jsdom jsdom-testing-mocks\n# or\nnpm install --save-dev jest babel-jest jest-environment-jsdom jsdom jsdom-testing-mocks\n```\n\nTo run your test using the test command :\n\n```json\n{\n  \"scripts\": {\n    \"test\": \"jest\"\n  }\n}\n```\n\n## A first basic test\n\nImagine we have a Cookie.js module, like so:\n\n```js\n/**\n * gets cookie value\n * @param {String} name : cookie name\n */\nexport const getCookie = (name) => {\n  return document.cookie.split('; ').reduce((r, v) => {\n    const parts = v.split('=')\n    return parts[0] === name ? decodeURIComponent(parts[1]) : r\n  }, '')\n}\n\n/**\n * Sets a cookie\n * @param {String} name : cookie name\n * @param {*} value : cookie value\n * @param {Number} days : cookie validity (in days)\n * @param {String} path : the path to get the cookie\n */\nexport const setCookie = (name, value, days = 7, path = '/') => {\n  const expires = new Date(Date.now() + days * 864e5).toUTCString()\n  document.cookie = name + '=' + encodeURIComponent(value) + '; expires=' + expires + '; path=' + path\n}\n\n/**\n * Cancella un cookie\n * @param {*} name : il nome del cookie\n * @param {*} path : il percorso per recuperare il cookie\n */\nexport const deleteCookie = (name, path = '/') => {\n  setCookie(name, '', -1, path)\n}\n```\n\ntesting the module could look like so:\n\n```js\n  /**\n * @jest-environment jsdom\n */\n\nimport { setCookie,getCookie,deleteCookie } from '../Cookie'\nimport { getCookie } from '../getCookie'\nimport { deleteCookie } from '../deleteCookie'\n\ndescribe('test Cookies functions', () => {\n  test(\"sets a 'pippo' cookie in / checks if it exists and deletes it\", () => {\n    setCookie('pippo', 3, 7)\n    expect(getCookie('pippo')).toBe('3')\n    deleteCookie('pippo')\n    expect(getCookie('pippo')).toBe('')\n  })\n})\n```\n\nPlease note that without jsdom and jest-environment-jsdom installed and the  @jest-environment comment the test would fail, as Cookie.js relies on the existence of the window.document object\n\n```js\n  /**\n * @jest-environment jsdom\n */\n```\n\n## Matchers\n\nMatchers let you validate the results and values of your tests in different ways.\n\nThey are most commonly used to compare the result of the expect() function to the value passed as an argument to the matcher (That is also what we did above).\n\nMost common matchers:\n\n- toBe -  compares for strict equality (e.g. ===)\n- toEqual - compares the values of two variables/objects\n- toBeNull - checks if the value is null\n- toBeDefined - checks if the value is defined\n- toBeUndefined - checks if the value is undefined\n- toBeTruthy - checks if the value is true (similar to an if statement)\n- toBeFalsy - checks if the value is false(similar to an if statement)\n- toBeGreaterThan - checks if the result of the expect() function is greater than the argument\n- toContain - checks if the result of expect() contains a value\n- toHaveProperty -  checks if an object has a property, and optionally checks its value\n- toBeInstanceOf - checks if an object is an instance of a class\n\nmatchers can also be negated using the not statement:\n\n```js\n  test(\"factorial of 3 is not 5\", () => {\n    expect(factorialize(3)).not.toBe(5);\n});\n```\n\n## Setup and Teardown\n\nOften when writing tests, you will have to do some kind of setup like initializing variables before tests run and some sort of action after they have finished, remember the **AAA Pattern** (Arrange, Act, Assert) ?\n\nJest provides two different ways you can do that.\n\n## One-Time Setup:\nIn some cases, you only need to do the setup once, at the beginning of your test file. In that scenario, you can use the beforeAll() and afterAll() helper functions that will execute before the tests start and after all have finished.\n\n\n```js\n beforeAll(() => {\n  return initializeDatabase();\n});\n\nafterAll(() => {\n  return clearDatabase();\n});\n\ntest('query from database', () => {\n  expect(database.getObject('Florida')).toBeTruthy();\n});\n```\n\n## Repeating setup for each test:\n\nIf you have a setup process that needs to run before each test than you should use the beforeEach() and afterEach() functions.\n\n```js\n beforeEach(() => {\n    IntersectionHandler.init({})\n    document.body.innerHTML = ''\n })\n afterEach(() => {\n     IntersectionHandler.clear()\n     jest.clearAllMocks()\n })\n```\n\n## Grouping tests\n\nYou can also group related tests together so you can isolate the setup and teardown functions. Grouping tests will also help you get a better overview of your different test cases.\n\n```js\n describe('testing factorial function', () => {\n    beforeAll(() => {\n    \t//do something\n    })\n    afterAll(() => {\n    \t//do something\n    })\n  \n    test(\"factorial of 3\", () => {\n    \texpect(factorialize(3)).toBe(6);\n    });\n\n    test(\"factorial of 5\", () => {\n        expect(factorialize(5)).toBe(120);\n    });\n\n    test(\"factorial of 3 is not 5\", () => {\n        expect(factorialize(3)).not.toBe(5);\n    });\n})\n```\n\n## Testing async functions\n\nIt is common for Javascript code to run asynchronously using either promises or callbacks. The problem with testing asynchronous code is knowing when the code that you are testing is actually complete. Jest has several ways to handle this.\n\n### Promises:\n\nTesting promises is straight forward in Jest. Just return the promise and Jest will wait for the promise to resolve. If the promise fails, the test will automatically fail aswell.\n\n```js\n// string.js\nexport const reverseString = str => {\n  return new Promise((resolve, reject) => {\n    if (!str) {\n      reject(\"Empty string\");\n      return;\n    }\n    resolve(str.split(\"\").reverse().join(\"\"));\n  });\n};\n```\n```js\n// string.spec.js\nimport {reverseString}  from  \"./string\";\n\ntest(`reverseString 'String' to equal 'gnirtS'`, () => {\n  return reverseString(\"String\").then(str => {\n    expect(str).toBe(\"gnirtS\");\n  });\n});\n```\n\nYou can also catch rejected promises using the catch() function.\n\n```js\ntest(`reverseString '' to reject promise`, () => {\n  return reverseString(\"String\").catch(error => {\n    expect(error).toMatch(\"Empty string\");\n  });\n});\n```\n\n### Async await:\nAlternatively, we can use async and await for testing promises.\n\nconst reverseString = require(\"./string\");\n\n  \n```js\ntest(`reverseString 'String' to equal 'gnirtS' using await`, async () => {\n    const str = await reverseString(\"String\")\n    expect(str).toBe(\"gnirtS\");\n});\n```\n\n### Callbacks:\n\nBy default Jest tests complete once they reach the end of their execution which means that the test will be completed before the callback is called. This can be fixed by passing a single argument named done to your test function. **Jest will wait until the done callback is called** before finishing the test.\n```js\n// string.js\nexport function reverseStringCallback(str, callback) {\n    callback(str.split(\"\").reverse().join(\"\"))\n}\n```\n\n```js\n// string.spec.js\nimport {reverseStringCallback}  from  \"./string\";\ntest(`reverseStringCallback 'string' to equal 'gnirts'`, (done) => {\n    reverseStringCallback('string', (str) => {\n      expect(str).toBe('gnirts')\n      done()\n    })\n})\n```\n\nNote that if done() is never called, the test will fail with a timeout error.\n\n\n## Mocking\n\nMocking is creating objects or services that simulate the behavior of real objects and plays a vital part in testing. The goal for mocking an object or function is to replace something we don’t control like an external service with something we do, that is why it’s essential that what we replace it with something that has all the features we need.\n\n### Passing Mocks to functions:\n\nOne of the common ways to use the Mock function is by passing it as an argument to the function you are testing. This allows you to run your tests without importing the real dependencies and objects you would pass in your real application.\n\n```js\nconst multiplyNumbers = (a, b, callback) => {\n  callback(a * b);\n};\n\ntest(\"calls callback with arguments added\", () => {\n  const mockCallback = jest.fn();\n  multiplyNumbers(1, 2, mockCallback);\n  expect(mockCallback).toHaveBeenCalledWith(2);\n});\n```\n\nThis strategy is great, but requires that your code supports dependency injection. If that is not the case you will need to mock already existing modules or functions instead.\n\n### Mocking a single function:\n\nYou can mock a single function using Jest.fn():\n\n```js\nconst lodash = require('lodash')\n\nlodash.chunk = jest.fn(() => 'test')\ntest(`Test lodash chunk function`, () => {\n    const result = lodash.chunk(['a', 'b', 'c', 'd'], 2)\n    expect(result).toBe('test')\n    expect(lodash.chunk).toHaveBeenCalled()\n    expect(lodash.chunk).toHaveBeenCalledWith(['a', 'b', 'c', 'd'], 2)\n})\n```\n\n### Mocking Modules:\n\nMocking single functions works well if you only use one or two functions of a package or library but can get very cluttered when you need more functions of a module. Here we use jest.mock to automatically set the exports of an entire module instead of mocking the modules manually.\n\n\n```js\nconst lodash = require('lodash')\njest.mock('lodash');\n\ntest(`Test lodash chunk function`, () => {\n    const result = lodash.chunk(['a', 'b', 'c', 'd'], 2)\n    expect(lodash.chunk).toHaveBeenCalled()\n    expect(lodash.chunk).toHaveBeenCalledWith(['a', 'b', 'c', 'd'], 2)\n\n    const concatResult = lodash.concat(2, [3], [[4]]);\n    expect(lodash.concat).toHaveBeenCalled()\n    expect(lodash.concat).toHaveBeenCalledWith(2, [3], [[4]])\n})\n```\n\n### Mocking ESModules\n\nJest was born with node modules in mind, in order to use it with ESModules you should install a transpiler such as **babel-jest**\n\nThen the syntax is slightly different :\n\n```js\nimport {loop} from '../loop'\nimport {ctx} from '../init'  // this is used in loop()\nimport { generateNoise } from '../generateNoise' // this is called in loop()\njest.mock('../generateNoise', () => ({\n    __esModule: true, // without this tests will fail\n    generateNoise: jest.fn(), // mocked function\n}));\njest.mock('../init', () => ({\n    __esModule: true, // without this tests will fail\n    ctx: jest.fn(), // mocked function\n}));\n\ndescribe('testing loop', () => {         \n    // @ts-ignore\n    it('calls loop  and verifies its logic', () => {\n        loop()\n        expect(generateNoise).toHaveBeenCalledWith(ctx)  \n    })\n})\n```\n\n## Spying packages:\n\nYou can also spy on a package without creating a mock for it. This is done using the spyOn() function provided by Jest.\n\n```js\nimport lodash from 'lodash'\n// or \nconst lodash = require('lodash')\n\n\ntest(`Test lodash chunk function`, () => {\n  const spy = jest.spyOn(lodash, 'chunk')\n  const result = lodash.chunk(['a', 'b', 'c', 'd'], 2)\n\n  expect(lodash.chunk).toHaveBeenCalled()\n  expect(lodash.chunk).toHaveBeenCalledWith(['a', 'b', 'c', 'd'], 2)\n})\n```\n\n\n## Expecting a function to throw error:\n\nYou should always take in account edge cases and the possibility that a funtion you are calling will generate an error.\n\nimagine we have a simple module which creates a div in anothe div:\n\n```js\nexport function createContainerInMount (selector) {\n  const mount = document.querySelector(selector)\n  if (mount) {\n    const container = document.createElement('div')\n    container.id = 'test'\n    mount.appendChild(container)\n    return container\n  }\n  throw new Error('no mount found')\n}\n```\n\nwe could test it like this:\n\n```js\n/**\n * @jest-environment jsdom\n */\n/* eslint-disable no-undef */\nimport { createContainerInMount } from '../createContainerInMount'\n\ndescribe('testing : createContainerInMount', () => {\n  test('mount exists ', () => {\n    document.body.innerHTML = `\n      <div id=\"test\"></div>\n    `\n    createContainerInMount('#test')\n    expect(document.querySelector('#test')).not.toBeNull()\n  })\n  test('mount does not exist ', () => {\n    document.body.innerHTML = `\n    `\n    expect(() => {\n      createContainerInMount('#test')\n    }).toThrow('no mount found') // Or .toThrow('expectedErrorMessage')\n  })\n})\n```\n";
				}
				function compiledContent() {
					return html;
				}
				function getHeadings() {
					return [{"depth":1,"slug":"introduction-to-jest","text":"Introduction to Jest"},{"depth":2,"slug":"installation","text":"Installation"},{"depth":2,"slug":"a-first-basic-test","text":"A first basic test"},{"depth":2,"slug":"matchers","text":"Matchers"},{"depth":2,"slug":"setup-and-teardown","text":"Setup and Teardown"},{"depth":2,"slug":"one-time-setup","text":"One-Time Setup:"},{"depth":2,"slug":"repeating-setup-for-each-test","text":"Repeating setup for each test:"},{"depth":2,"slug":"grouping-tests","text":"Grouping tests"},{"depth":2,"slug":"testing-async-functions","text":"Testing async functions"},{"depth":3,"slug":"promises","text":"Promises:"},{"depth":3,"slug":"async-await","text":"Async await:"},{"depth":3,"slug":"callbacks","text":"Callbacks:"},{"depth":2,"slug":"mocking","text":"Mocking"},{"depth":3,"slug":"passing-mocks-to-functions","text":"Passing Mocks to functions:"},{"depth":3,"slug":"mocking-a-single-function","text":"Mocking a single function:"},{"depth":3,"slug":"mocking-modules","text":"Mocking Modules:"},{"depth":3,"slug":"mocking-esmodules","text":"Mocking ESModules"},{"depth":2,"slug":"spying-packages","text":"Spying packages:"},{"depth":2,"slug":"expecting-a-function-to-throw-error","text":"Expecting a function to throw error:"}];
				}
				async function Content() {
					const { layout, ...content } = frontmatter;
					content.file = file;
					content.url = url;
					const contentFragment = createVNode(Fragment, { 'set:html': html });
					return contentFragment;
				}
				Content[Symbol.for('astro.needsHeadRendering')] = true;

export { Content, compiledContent, Content as default, file, frontmatter, getHeadings, images, rawContent, url };
