import{r as y}from"./index.ed373d49.js";import{A as C,T as I,S as A}from"./HTMLText.22f2e038.js";import{I as f}from"./IntersectionHandler.7eaf436d.js";import{j as E}from"./jsx-runtime.391947bd.js";let t;async function T(s){t=new C({background:"#000000",resizeTo:s}),s.appendChild(t.view);const p=await I.from("/star.png"),a=1e3;let n=0;const c=20,v=.025;let d=0,M=0;const S=5,m=.05,g=[];for(let i=0;i<a;i++){const r={sprite:new A(p),z:0,x:0,y:0};r.sprite.anchor.x=.5,r.sprite.anchor.y=.7,x(r,!0),t.stage.addChild(r.sprite),g.push(r)}function x(i,r){i.z=r?Math.random()*2e3:n+Math.random()*1e3+2e3;const e=Math.random()*Math.PI*2,o=Math.random()*50+1;i.x=Math.cos(e)*o,i.y=Math.sin(e)*o}t.ticker.add(i=>{d+=(M-d)/20,n+=i*10*(d+v);for(let r=0;r<a;r++){const e=g[r];e.z<n&&x(e);const o=e.z-n;e.sprite.x=e.x*(c/o)*t.renderer.screen.width+t.renderer.screen.width/2,e.sprite.y=e.y*(c/o)*t.renderer.screen.width+t.renderer.screen.height/2;const l=e.sprite.x-t.renderer.screen.width/2,h=e.sprite.y-t.renderer.screen.height/2,z=Math.sqrt(l*l+h*h),u=Math.max(0,(2e3-o)/2e3);e.sprite.scale.x=u*m,e.sprite.scale.y=u*m+u*d*S*z/t.renderer.screen.width,e.sprite.rotation=Math.atan2(h,l)+Math.PI/2}})}function w(){console.log("app start"),t.start()}function b(){console.log("app stop"),t.stop()}function V(){t.stop(),t.destroy()}const B=()=>{const s=y.useRef(null),p=n=>{console.log("handleAppIntersection");const{isIntersecting:c}=n;c?w():b()},a=()=>{console.log("handleVisibilityChange"),document.visibilityState==="visible"?s.current.getBoundingClientRect().top+window.innerHeight>0&&w():b()};return y.useEffect(()=>{const n={root:null,rootMargin:"0px",threshold:.01};return f.init(n),f.observe(s.current,p),T(s.current),document.addEventListener("visibilitychange",a),()=>{document.removeEventListener("visibilitychange",a),f.unobserve(s.current),V()}},[]),E.jsx("div",{ref:s,className:"flex grow pr-2"})};export{B as default};
